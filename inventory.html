<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Инвентарь</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f7f9fc;
        }

        .inventory-container {
            max-width: 600px;
            margin: auto;
            padding: 20px;
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .item {
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        .balance {
            font-size: 1.2em;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="inventory-container">
        <h2>Инвентарь</h2>
        <div class="balance">Баланс: <span id="balance"></span></div>
        <div id="itemList"></div>
    </div>

    <script>
        const firebaseDatabaseURL = "https://so2project-2e2b2-default-rtdb.firebaseio.com/";
        const username = localStorage.getItem('username'); // Получаем логин из localStorage

        if (!username) {
            alert("Пожалуйста, войдите в систему");
            window.location.href = 'login.html'; // Перенаправляем на страницу входа, если логин не найден
        }

        const inventoryURL = `${firebaseDatabaseURL}users/${username}/inventory.json`; // URL для инвентаря
        const goldURL = `${firebaseDatabaseURL}users/${username}/gold.json`; // URL для золота

        // Функция для получения инвентаря и золота пользователя
        async function fetchInventory() {
            try {
                // Получаем инвентарь пользователя
                const response = await fetch(inventoryURL);
                const inventory = await response.json();

                if (inventory) {
                    // Отображаем предметы инвентаря
                    const itemList = document.getElementById('itemList');
                    itemList.innerHTML = '';

                    // Извлекаем имена предметов
                    const itemNames = inventory.ItemNames || [];
                    itemNames.forEach(item => {
                        const itemDiv = document.createElement('div');
                        itemDiv.className = 'item';
                        itemDiv.textContent = item; // Отображаем имя предмета
                        itemList.appendChild(itemDiv);
                    });

                    // Получаем и отображаем золото (по адресу `users/{username}/gold/gold`)
                    const goldResponse = await fetch(goldURL);
                    const goldData = await goldResponse.json();
                    const goldAmount = goldData && goldData.gold ? goldData.gold : 0; // Извлекаем количество золота
                    document.getElementById('balance').textContent = goldAmount; // Отображаем золото
                } else {
                    document.getElementById('itemList').textContent = "Инвентарь пуст.";
                }
            } catch (error) {
                console.error("Ошибка при запросе:", error);
                alert("Ошибка при запросе: " + error.message);
            }
        }

        // Загружаем инвентарь при загрузке страницы
        fetchInventory();
    </script>
</body>
</html>
